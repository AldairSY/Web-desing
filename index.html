<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de Evaluaci√≥n de Proyectos de Investigaci√≥n e Innovaci√≥n - IEST Andr√©s Avelino C√°ceres Dorregaray">
    <meta name="theme-color" content="#00D9FF">
    <title>Sistema de Investigaci√≥n e Innovaci√≥n - IEST</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- PANTALLA DE LOGIN -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <div class="logo-container">
                <img src="logo-upla.png" alt="Logo IEST Andr√©s Avelino C√°ceres Dorregaray" class="logo">
                <h1>Sistema de Investigaci√≥n e Innovaci√≥n</h1>
            </div>
            
            <form id="loginForm" class="login-form" aria-labelledby="login-heading">
                <h2 id="login-heading" class="sr-only">Formulario de inicio de sesi√≥n</h2>
                <div class="form-group">
                    <label for="email">Correo Institucional</label>
                    <input type="email" id="email" name="email" required 
                           placeholder="tu.email@iest.edu.pe"
                           autocomplete="email">
                </div>
                
                <div class="form-group">
                    <label for="password">Contrase√±a</label>
                    <input type="password" id="password" name="password" required 
                           placeholder="Ingresa tu contrase√±a"
                           autocomplete="current-password">
                </div>
                
                <button type="submit" class="btn btn-primary btn-large">
                    <span>Iniciar Sesi√≥n</span>
                </button>
                
                <div id="loginError" class="error-message" role="alert" aria-live="polite"></div>
            </form>
        </div>
    </div>

    <!-- PANTALLA DE DASHBOARD -->
    <div id="dashboardPage" class="page">
        <nav class="navbar">
            <div class="navbar-brand">
                <img src="logo-upla.png" alt="Logo IEST" class="navbar-logo">
                <span class="navbar-title">Sistema de Investigaci√≥n e Innovaci√≥n</span>
            </div>
            <div class="navbar-user">
                <span class="user-name" id="userName">Usuario</span>
                <button id="logoutBtn" class="btn btn-secondary btn-small">Cerrar Sesi√≥n</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <header class="dashboard-header">
                <h1 class="page-title">Categor√≠as de Innovaci√≥n</h1>
                <p class="page-subtitle">Selecciona una categor√≠a para ver y gestionar proyectos</p>
            </header>

            <div class="categories-grid">
                <div class="category-card" data-category="tecnologica">
                    <div class="category-icon">üíª</div>
                    <h3>Innovaci√≥n Tecnol√≥gica</h3>
                    <p>Proyectos de desarrollo tecnol√≥gico y software</p>
                    <button class="btn btn-primary" onclick="selectCategory('tecnologica')">
                        Ver Proyectos
                    </button>
                </div>
                <div class="category-card" data-category="aplicada">
                    <div class="category-icon">üî¨</div>
                    <h3>Innovaci√≥n Aplicada</h3>
                    <p>Proyectos de investigaci√≥n aplicada</p>
                    <button class="btn btn-primary" onclick="selectCategory('aplicada')">
                        Ver Proyectos
                    </button>
                </div>
                <div class="category-card" data-category="pedagogica">
                    <div class="category-icon">üìö</div>
                    <h3>Innovaci√≥n Pedag√≥gica</h3>
                    <p>Proyectos de mejora educativa</p>
                    <button class="btn btn-primary" onclick="selectCategory('pedagogica')">
                        Ver Proyectos
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PANTALLA DE LISTA DE PROYECTOS -->
    <div id="projectsListPage" class="page">
        <nav class="navbar">
            <div class="navbar-brand">
                <img src="logo-upla.png" alt="Logo IEST" class="navbar-logo">
                <span class="navbar-title">Sistema de Investigaci√≥n e Innovaci√≥n</span>
            </div>
            <div class="navbar-user">
                <span class="user-name" id="userName2">Usuario</span>
                <button id="logoutBtn2" class="btn btn-secondary btn-small">Cerrar Sesi√≥n</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('dashboardPage')">
                    ‚Üê Volver
                </button>
                <h1 id="categoryTitle">Proyectos</h1>
            </div>

            <!-- FILTROS AVANZADOS -->
            <div class="filters-section">
                <div class="search-bar">
                    <div class="search-input-wrapper">
                        <input 
                            type="text" 
                            id="searchInput" 
                            class="search-input-large" 
                            placeholder="üîç Buscar por nombre del proyecto...">
                    </div>
                    <button class="btn btn-primary btn-add" onclick="showPage('newProjectPage')">
                        + Agregar Nuevo Proyecto
                    </button>
                </div>
                
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="filterType">Filtrar por Tipo:</label>
                        <select id="filterType" class="filter-select">
                            <option value="">Todos los tipos</option>
                            <option value="aplicada">Aplicada</option>
                            <option value="innovacion">Innovaci√≥n</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterProgram">Filtrar por Programa:</label>
                        <input 
                            type="text" 
                            id="filterProgram" 
                            class="filter-input" 
                            placeholder="Nombre del programa...">
                    </div>
                    
                    <div class="filter-actions">
                        <button class="btn btn-secondary btn-clear" onclick="clearFilters()">
                            üóëÔ∏è Limpiar Filtros
                        </button>
                        <div class="results-counter">
                            <strong id="resultsCount">0</strong> proyectos encontrados
                        </div>
                    </div>
                </div>
            </div>

            <div id="projectsList" class="projects-grid">
                <!-- Los proyectos se cargar√°n din√°micamente aqu√≠ -->
            </div>

            <div id="noProjects" class="empty-state" style="display: none;">
                <div class="empty-icon">üìã</div>
                <h3>No hay proyectos que coincidan con tu b√∫squeda</h3>
                <p>Intenta ajustar los filtros o agregar un nuevo proyecto</p>
                <button class="btn btn-primary" onclick="showPage('newProjectPage')">
                    Agregar Proyecto
                </button>
            </div>
        </div>
    </div>

    <!-- PANTALLA DE NUEVO PROYECTO -->
    <div id="newProjectPage" class="page">
        <nav class="navbar">
            <div class="navbar-brand">
                <img src="logo-upla.png" alt="Logo IEST" class="navbar-logo">
                <span class="navbar-title">Sistema de Investigaci√≥n e Innovaci√≥n</span>
            </div>
            <div class="navbar-user">
                <span class="user-name" id="userName3">Usuario</span>
                <button id="logoutBtn3" class="btn btn-secondary btn-small">Cerrar Sesi√≥n</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('projectsListPage')">
                    ‚Üê Volver
                </button>
                <h1 class="page-title">‚ú® Agregar Nuevo Proyecto de Innovaci√≥n</h1>
            </div>

            <form id="newProjectForm" class="project-form">
                <div class="form-group">
                    <label for="projectName">T√≠tulo del Proyecto *</label>
                    <input type="text" id="projectName" name="projectName" required 
                           placeholder="T√≠tulo completo del proyecto">
                </div>
                <div class="form-group">
                    <label for="projectType">Tipo de Investigaci√≥n *</label>
                    <select id="projectType" name="projectType" required>
                        <option value="">Seleccionar...</option>
                        <option value="aplicada">Aplicada</option>
                        <option value="innovacion">Innovaci√≥n</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="lineaInvestigacion">L√≠nea de Investigaci√≥n (Programa de Estudios) *</label>
                    <input type="text" id="lineaInvestigacion" name="lineaInvestigacion" required 
                           placeholder="L√≠nea de investigaci√≥n del proyecto">
                </div>
                <div class="form-group">
                    <label for="integrantesIntegrantes">Integrante o Integrantes *</label>
                    <textarea id="integrantesIntegrantes" name="integrantesIntegrantes" rows="3" required
                              placeholder="Nombres completos de los integrantes (separados por coma)"></textarea>
                </div>
                <div class="form-group">
                    <label for="objetivoProyecto">Objetivo del Proyecto *</label>
                    <textarea id="objetivoProyecto" name="objetivoProyecto" rows="4" required
                              placeholder="Describa el objetivo principal del proyecto"></textarea>
                </div>
                <div class="form-group">
                    <label for="beneficiarios">Beneficiarios *</label>
                    <textarea id="beneficiarios" name="beneficiarios" rows="3" required
                              placeholder="¬øQui√©nes se beneficiar√°n con este proyecto?"></textarea>
                </div>
                <div class="form-group">
                    <label for="localizacion">Localizaci√≥n *</label>
                    <input type="text" id="localizacion" name="localizacion" required 
                           placeholder="Ubicaci√≥n donde se desarrollar√° el proyecto">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="fechaInicio">Fecha de Inicio *</label>
                        <input type="date" id="fechaInicio" name="fechaInicio" required>
                    </div>
                    <div class="form-group">
                        <label for="fechaFin">Fecha de Finalizaci√≥n *</label>
                        <input type="date" id="fechaFin" name="fechaFin" required>
                    </div>
                </div>
                <!-- CAMPO PDF SOLO PDF Y 10MB -->
                <div class="form-group">
                    <label for="projectPDF">Documento PDF del Proyecto *</label>
                    <input 
                        type="file" 
                        id="projectPDF" 
                        name="projectPDF" 
                        accept="application/pdf"
                        required
                        onchange="validatePDF(this)">
                    <small class="form-help">
                        Solo se aceptan archivos en formato PDF (.pdf), tama√±o m√°ximo 10MB
                    </small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="showPage('projectsListPage')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        üíæ Guardar Proyecto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- PANTALLA DE EVALUACI√ìN DIN√ÅMICA -->
    <div id="evaluationPage" class="page">
        <nav class="navbar">
            <div class="navbar-brand">
                <img src="logo-upla.png" alt="Logo IEST" class="navbar-logo">
                <span class="navbar-title">Sistema de Investigaci√≥n e Innovaci√≥n</span>
            </div>
            <div class="navbar-user">
                <span class="user-name" id="userName4">Usuario</span>
                <button id="logoutBtn4" class="btn btn-secondary btn-small">Cerrar Sesi√≥n</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('projectsListPage')">
                    ‚Üê Volver
                </button>
                <h1 class="page-title" id="evalProjectTitle">Evaluaci√≥n del Proyecto</h1>
            </div>
            <div class="evaluation-container">
                <!-- Informaci√≥n del Proyecto -->
                <div class="project-info-card">
                    <h3>Informaci√≥n del Proyecto</h3>
                    <div id="projectInfoDisplay"></div>
                </div>
                <!-- Formulario de Evaluaci√≥n Din√°mico (se genera con JS) -->
                <div id="dynamicEvaluationContainer"></div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabaseClient.js"></script>
    <script src="app.js"></script>
    <!-- Script para validar PDF HU-03 -->
    <script>
    function validatePDF(input) {
        const file = input.files[0];
        if (file) {
            if (file.type !== "application/pdf") {
                alert("Solo se permiten archivos PDF (.pdf).");
                input.value = "";
                return;
            }
            if (file.size > 10 * 1024 * 1024) {
                alert("El archivo no debe superar los 10MB.");
                input.value = "";
                return;
            }
        }
    }
    </script>
</body>
</html>

